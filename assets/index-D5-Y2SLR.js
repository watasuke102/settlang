(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))o(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const a of n.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&o(a)}).observe(document,{childList:!0,subtree:!0});function t(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function o(e){if(e.ep)return;e.ep=!0;const n=t(e);fetch(e.href,n)}})();const l=document.getElementById("run"),s=document.getElementById("output_area"),m=document.getElementById("input_area");if(!l||!s||!m)throw new Error;const _=new TextEncoder,w=new TextDecoder;let h;function g(c,...i){let o=(()=>{const e=[];let n=BigInt(8);for(;;){const d=h.getUint8(Number(c+n));if(d==0)break;e.push(d),++n}const a=new Uint8Array(e);return w.decode(a)})().split("{}");for(let e=0;e<o.length;++e)s.value+=o[e],e!==o.length-1&&(s.value+=i[e]??"")}async function E(){const c=await(async()=>{try{const t=await fetch("/compiler.wasm");return!t.ok||!t.body||!(t.body instanceof ReadableStream)?(output.innerText="Failed to load : invalid response",null):WebAssembly.instantiateStreaming(t)}catch(t){return l.innerText="Failed to load",output.innerText="Failed to load : "+t,null}})();if(!c)return;const i=async()=>{try{s.value="";const t=_.encode(m.value+" "),o=16;new Uint8Array(c.instance.exports.memory.buffer).set(t,o);const e=c.instance.exports.build(o,t.length),n=new DataView(c.instance.exports.memory.buffer),a=n.getUint32(e+0)===1,d=n.getUint32(e+4),p=(()=>{const r=[];for(let u=0;u<d;++u){const f=n.getUint8(e+8+u);r.push(f)}return new Uint8Array(r)})();if(!a){s.value=w.decode(p);return}const y=await WebAssembly.instantiate(p,{std:{print:g,println:(r,...u)=>{g(r,...u),s.value+=`
`},read:()=>{try{const r=window.prompt("Please enter a number")??"0";return BigInt(r)}catch{return BigInt(0)}},random:(r,u)=>{try{const f=Number(u),b=Number(r),x=Math.floor(Math.random()*(f-b)+b);return BigInt(x)}catch{return BigInt(0)}}}});h=new DataView(y.instance.exports.memory.buffer);const v=y.instance.exports.main();s.value+="result="+v}catch(t){throw s.value+="[error] failed to execute : "+t,t}};l.removeAttribute("disabled"),l.innerText="Run (Ctrl+Enter)",l.onclick=i,m.addEventListener("keydown",t=>{t.ctrlKey&&t.code==="Enter"&&i()})}E();
